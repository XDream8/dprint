!function(){"use strict";var e,t,n,r={};function o(e){var t=new WebAssembly.Module(e);return a(new WebAssembly.Instance(t,{dprint:{host_clear_bytes:function(){},host_read_buffer:function(){},host_write_buffer:function(){},host_take_file_path:function(){},host_take_override_config:function(){},host_format:function(){return 0},host_get_formatted_text:function(){return 0},host_get_error_text:function(){return 0}}}))}function a(e){var t=e.exports,n=t.get_plugin_schema_version,r=t.set_file_path,o=t.set_override_config,a=t.get_formatted_text,i=t.format,s=t.get_error_text,f=t.get_plugin_info,c=t.get_resolved_config,u=t.get_config_diagnostics,g=t.set_global_config,_=t.set_plugin_config,l=t.get_license_text,h=t.get_wasm_memory_buffer,d=t.get_wasm_memory_buffer_size,m=t.add_to_shared_bytes_from_buffer,p=t.set_buffer_with_shared_bytes,v=t.clear_shared_bytes,y=t.reset_config,b=n();if(2!==b&&3!==b)throw new Error("Not compatible plugin. "+"Expected schema ".concat(3,", ")+"but plugin had ".concat(b,"."));var w=d(),x=!1;return{setConfig:function(e,t){C(e,t)},getConfigDiagnostics:function(){P();var e=u();return JSON.parse(M(e))},getResolvedConfig:function(){P();var e=c();return JSON.parse(M(e))},getPluginInfo:function(){var e,t=f(),n=JSON.parse(M(t));return n.fileNames=null!==(e=n.fileNames)&&void 0!==e?e:[],n},getLicenseText:function(){return M(l())},formatText:function(e,t,n){if(P(),null!=n){if(2===b)throw new Error("Cannot set the override configuration for this old plugin.");N(JSON.stringify(n)),o()}N(e),r(),N(t);var f=i();switch(f){case 0:return t;case 1:return M(a());case 2:throw new Error(M(s()));default:throw new Error("Unexpected response code: ".concat(f))}}};function P(){x||C({},{})}function C(e,t){null!=y&&y(),N(JSON.stringify(e)),g(),N(JSON.stringify(t)),_(),x=!0}function N(e){var t=(new TextEncoder).encode(e),n=t.length;v(n);for(var r=0;r<n;){for(var o=Math.min(n-r,w),a=T(o),i=0;i<o;i++)a[i]=t[r+i];m(o),r+=o}}function M(e){for(var t=new Uint8Array(e),n=0;n<e;){var r=Math.min(e-n,w);p(n,r);for(var o=T(r),a=0;a<r;a++)t[n+a]=o[a];n+=r}return(new TextDecoder).decode(t)}function T(t){var n=h();return new Uint8Array(e.exports.memory.buffer,n,t)}}var i=new AbortController;function s(e,t){!function(e){try{e()}catch(t){c(t)}}((function(){return e.setConfig({},t)}))}function f(e,t,n){var r;try{r=e.formatText(t,n)}catch(o){r=o.message}postMessage({type:"Format",text:r})}function c(e){postMessage({type:"Error",message:e.message})}onmessage=function(r){switch(r.data.type){case"LoadUrl":!function(r){i.abort();var a=(i=new AbortController).signal;(e=fetch(r,{signal:a}).then((function(e){return e.arrayBuffer()})).then((function(e){var r=o(e);return postMessage({type:"PluginInfo",info:r.getPluginInfo()}),t&&s(r,t),n&&f(r,n.filePath,n.fileText),r}))).catch((function(e){a.aborted||c(e)}))}(r.data.url);break;case"SetConfig":g=r.data.config,t=g,e&&e.then((function(e){t&&s(e,t),n&&f(e,n.filePath,n.fileText)}));break;case"Format":a=r.data.filePath,u=r.data.fileText,n={filePath:a,fileText:u},e&&e.then((function(e){return f(e,a,u)}))}var a,u,g},addEventListener("message",(function(e){var t,n=e.data,o=n.type,a=n.method,i=n.id,s=n.params;"RPC"===o&&a&&((t=r[a])?Promise.resolve().then((function(){return t.apply(r,s)})):Promise.reject("No such method")).then((function(e){postMessage({type:"RPC",id:i,result:e})})).catch((function(e){var t={message:e};e.stack&&(t.message=e.message,t.stack=e.stack,t.name=e.name),postMessage({type:"RPC",id:i,error:t})}))})),postMessage({type:"RPC",method:"ready"})}();
//# sourceMappingURL=b2b180bd7afac0560aba.worker.js.map